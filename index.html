<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="SHORTCUT ICON" sizes="16x16" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href='main.css'>
    <title>Zoho Sheet - IFrame Test</title>
</head>

<body>
    <div class="header">
        <div class="fleft" id="title">ZohoSheet</div>
        <button class="fright" id="savebtn">Save</button>
        <button class="fright" id="exportbtn">Export</button>
    </div>
    <div>
<!--         https://workdrive.zohoexternal.com/external/0119ce4ee586d41c75ad68600420077fa02686644ab24fb898e875fcc564a3bd -->
        
        <iframe id="sheetIframe"
            src="https://sheet.zoho.in/sheet/officeapi/v1/969e4fe9e98f6d1b74a7707bf44a1eba97badb52d03f844572386e173f2b078d3ab0f634f975c6b20aabb33dc4d63f8dae24ad86dc7ef2eb1d90e8b1184a58db"
            style="width:100%;height:90vh;"></iframe>
    </div>
    <script type="text/javascript" src="main.js"></script>
    <script>
//         (function (ctx) {
//             var savebtn = document.getElementById("savebtn");
//             var exportbtn = document.getElementById("exportbtn");
//             var sheetIframe = document.getElementById("sheetIframe");
//             XDC.setTarget({
//                 "origin": "https://sheet.localzoho.com",
//                 "window": document.getElementById("sheetIframe").contentWindow
//             });
//             savebtn.addEventListener("click", function () {
//                 XDC.postMessage({
//                     "message": "SaveSpreadsheet",
//                     "data": {},
//                     "oncomplete": function (data) {
//                         console.log("success", data);
//                     },
//                     "onexception": function (data) {
//                         console.log("failed", data);
//                     }
//                 });
//             })
//             exportbtn.addEventListener("click", function () {
//                 XDC.postMessage({
//                     "message": "ExportSpreadsheet",
//                     "data": {
//                         "format": "xlsx"
//                     },
//                     "oncomplete": function (data) {
//                         console.log("success", data);
//                     },
//                     "onexception": function (data) {
//                         console.log("failed", data);
//                     }
//                 });
//             })
//             XDC.receiveMessage("SaveSpreadsheetResponse", function(data) {
//                     console.log("SaveSpreadsheetResponse",data);
//             });
//             XDC.receiveMessage("ExportSpreadsheetResponse", function(data) {
//                      console.log("ExportSpreadsheetResponse",data);
//             });
//         }(this))
    </script>
</body>

</html>
