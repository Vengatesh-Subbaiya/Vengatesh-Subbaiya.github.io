<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="SHORTCUT ICON" sizes="16x16" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href='main.css'>
    <title>Zoho Sheet - Office Integrator</title>
</head>

<body>
    <div class="header">
        <div class="fleft" id="title">ZohoSheet Office Integrator</div>
        <button class="fright" id="savebtn">Save</button>
        <button class="fright" id="exportbtn">Export</button>
    </div>
    <div>
        <iframe id="sheetIframe"
            src="https://sheet.localzoho.com/sheet/officeapi/v1/488126245e56b5c7c328ae34a396b8631b6a259ae28fa9bd9429a05e5ac1df0854db761dd1350b752e5c9366b0cbfbacc4429d28afe4e47ea627b530ef65314e"
            style="width:100%;height:90vh;"></iframe>
    </div>
    <script type="text/javascript" src="main.js"></script>
    <script>
        (function (ctx) {
            var savebtn = document.getElementById("savebtn");
            var exportbtn = document.getElementById("exportbtn");
            var sheetIframe = document.getElementById("sheetIframe");
            XDC.setTarget({
                "origin": "https://sheet.localzoho.com",
                "window": document.getElementById("sheetIframe").contentWindow
            });
            savebtn.addEventListener("click", function () {
                XDC.postMessage({
                    "message": "SaveSpreadsheet",
                    "data": {},
                    "oncomplete": function (data) {
                        console.log("success", data);
                    },
                    "onexception": function (data) {
                        console.log("failed", data);
                    }
                });
            })
            exportbtn.addEventListener("click", function () {
                XDC.postMessage({
                    "message": "ExportSpreadsheet",
                    "data": {
                        "format": "xlsx"
                    },
                    "oncomplete": function (data) {
                        console.log("success", data);
                    },
                    "onexception": function (data) {
                        console.log("failed", data);
                    }
                });
            })
            XDC.receiveMessage("SaveSpreadsheetResponse", function(data) {
                    console.log("SaveSpreadsheetResponse",data);
            });
            XDC.receiveMessage("ExportSpreadsheetResponse", function(data) {
                     console.log("ExportSpreadsheetResponse",data);
            });
        }(this))
    </script>
</body>

</html>
